GOSUB SETREGVARSGOSUB GETZPSTRINGPRINT DA$MY.LOADPROGRAM$=ZP.STRING$F$=ZP.STRING$FE%=0FFLAGS=0GOTO MAIN IF LEN(F$)>0 THEN GOSUB FILEEXISTS IF FE% THEN STARTFILECHECK    COLOR 5    PRINT    PRINT "HANGMAN FILE CHECKER IS MEANT TO BE CALLED FROM HANGMAN"    PRINT "NOT RUN DIRECTLY.  CALLER NOT FOUND !":PRINT:COLOR 1:ENDMAIN:      COUNT=0      F$="HANGMAN.INI"      GOSUB FILEEXISTS      COUNT=COUNT+1      IF NOT FE% AND COUNT<2 THEN GOSUB CREATEHANGINI:GOTO MAIN      IF FE% THEN GOSUB FOUNDMSG:FFLAGS = FFLAGS OR %00000001      IF NOT FE% THEN DM$="MISSING HANGMAN.INI":GOTO ERRORHALT      COUNT=0CHECKDPAL:      F$="DPAL.BIN"      GOSUB FILEEXISTS      COUNT=COUNT+1      IF NOT FE% AND COUNT<2 THEN GOSUB CREATEDPALBIN:GOTO CHECKDPAL      IF FE% THEN FFLAGS = FFLAGS OR %00000010:GOSUB FOUNDMSG      IF NOT FE% THEN DM$="MISSING DPAL.BIN":GOTO ERRORHALT      COUNT=0CHECKBVSAVE:      F$="BVSAVEMCI.BIN"      GOSUB FILEEXISTS      COUNT=COUNT+1      IF NOT FE% AND COUNT<2 THEN GOSUB CREATEBVSAVE:GOTO CHECKBVSAVE      IF FE% THEN FFLAGS = FFLAGS OR %00000100:GOSUB FOUNDMSG      IF FE% THEN COLOR 7:PRINT " LOADING: ";:COLOR 1:PRINT F$:BLOAD F$,8,1,$0700      FC%=0      GOSUB COUNTWORDFILES      IF FC% >= 1 THEN SKIPHALT      DM$=" HWORD*.DAT FILES ARE MISSING":GOTO ERRORHALTSKIPHALT:      FFLAGS = FFLAGS OR %00001000CHECKSPLASHSCREEN:## PASS BACK THE NUMBER OF WORD FILES IN R15H      POKE R15H, FC%## JUST A SIGNATURE TO LET MAIN PROGRAM THAT THIS WAS RUN## LEFT IN GOLDEN RAM      POKE $400, $FF:POKE $401, $FE:POKE $402, $FF:POKE $403, $FEENDCOUNTWORDFILES:    FC%=0CNTINC:    SF$=RIGHT$(STR$(FC%+1),LEN(STR$(FC%+1))-1)    SF$=SF$+".DAT":F$="WORDS/HWORDS"+SF$    GOSUB FILEEXISTS:IF FE% THEN GOSUB FOUNDMSG:FC%=FC%+1:GOTO CNTINC    COLOR 7    PRINT:PRINT " ";FC%;    COLOR 1:PRINT " WORD FILES FOUND!":SLEEP 60:RETURNCREATEBVSAVE:F$="BVSAVEMCI.BIN":GOSUB NOTFOUNDMSGGOSUB CREATEMSGOPEN 5,8,5,"@:"+F$+",S,W"RESTORE BVSAVECOLOR 5FOR I = 1 TO 75    READ A    PRINT# 5,CHR$(A);    PRINT ".";NEXT ICOLOR 1PRINTCLOSE 5RETURNCREATEDPALBIN:   F$="DPAL.BIN":GOSUB NOTFOUNDMSG   GOSUB CREATEMSG   OPEN 5,8,5,"@:"+F$+",S,W"   RESTORE PALDATA   COLOR 5   FOR I = 1 TO 256       READ A       READ B       PRINT# 5, CHR$(B);CHR$(A);       PRINT ".";   NEXT I   COLOR 1   PRINT   CLOSE 5RETURNCREATEHANGINI:   F$="HANGMAN.INI":GOSUB NOTFOUNDMSG   GOSUB CREATEMSG   OPEN 5,8,5,"@:"+F$+",S,W"   RESTORE INIDATA   COLOR 5   FOR I = 1 TO 55       READ L$       PRINT# 5, L$       PRINT ".";   NEXT I   COLOR 1   PRINT   CLOSE 5RETURNGETHIRAM:  POKE C.REG,1:SYS$FF99  HI.BANK = PEEK(A.REG):IF LAST.BANK=0 THEN HI.BANK=255  BANKS.AVAILABLE = HI.BANK-2  NEXT.BANK=2CLRRREGS:   FOR I=R0 TO R14H:POKE I, 0:NEXT I:RETURNPUTZPMSG:   ZP.STRING$=ZP.MSG$   GOSUB PUTZPSTRING   RETURNGETZPSTRING:  ZP1 = R0  ZP.STRING$=""ZLOOP:  Z=PEEK(ZP1)  IF Z=0 THEN RETURN  ZP.STRING$=ZP.STRING$ + CHR$(Z)  ZP1=ZP1+1  IF ZP1 < R15H THEN ZLOOPPUTZPSTRING:   IF LEN(ZP.STRING$)<32 AND LEN(ZP.STRING$)>0 THEN DOZPUT   IF LEN(ZP.STRING$)=0 THEN POKE R0, 0:RETURN   PRINT ZP.STRING$   PRINT "STRING TO LONG FOR ZERO REGISTERS (MAX 31 CHARS)":ENDDOZPUT:   ZP1 = R0   FOR I=1 TO LEN(ZP.STRING$)       POKE ZP1, ASC(MID$(ZP.STRING$,I,1))       ZP1=ZP1 + 1   NEXT I   POKE ZP1,0   RETURNSETREGVARS:  A.REG = $030C  X.REG = $030D  Y.REG = $030E  C.REG = $030F  SET.MEM = $FF99  R0L=$02:R0H=$03:R0=R0L  R1L=$04:R1H=$05:R1=R1L  R2L=$06:R2H=$07:R2=R2L  R3L=$08:R3H=$09:R3=R3L  R4L=$A:R4H=$B:R4=R4L  R5L=$C:R5H=$D:R5=R5L  R6L=$E:R6H=$F:R6=R6L  R7L=$10:R7H=$11:R7=R7L  R8L=$12:R8H=$13:R8=R8L  R9L=$14:R9H=$15:R9=R9L  R10L=$16:R10H=$17:R10=R10L  R11L=$18:R11H=$19:R11=R11L  R12L=$1A:R12H=$1B:R12=R12L  R13L=$1C:R13H=$1D:R13=R13L  R14L=$1E:R14H=$1F:R14=R14L  R15L=$20:R15H=$21:R15=R15L  RETURNFILEEXISTS:   X$=F$:FE%=0:X$=X$+",S,R"   OPEN 2,8,2,X$:CLOSE 2   OPEN 15,8,15:INPUT#15,X,X$,A,B   CLOSE 15:FE%=(X<=20):RETURNNOTFOUNDMSG:  PRINT:COLOR 1:PRINT F$;:COLOR 5:PRINT " NOT FOUND.."  COLOR 1:RETURNFOUNDMSG:   PRINT:COLOR 5:PRINT " FOUND: ";:COLOR 1:PRINT F$   RETURNCREATEMSG:   COLOR 7   PRINT:PRINT "CREATING: ";:COLOR 1:PRINT F$;".";   RETURNRGBPAL:      A=P1*2:GB%=(G%*16)+B%:A=A+$FA00      SLEEP:VPOKE 1,A,GB%:A=A+1:SLEEP:VPOKE 1,A,R%      RETURNERRORHALT:     P1=5:R%=0:G%=14:B%=2:GOSUB RGBPAL:P1=15:R%=2:G%=2:GOSUB RGBPAL     COLOR 5,15:PRINT:PRINT:PRINT " ERROR ENCOUNTERED":PRINT " ";DM$:ENDBVSAVE:   DATA $AA,$20,$C9,$FF,$9C,$4B,$07,$A9,$2C,$8D,$4C,$07,$A9,$01,$8D,$4D,$07,$A2   DATA $23,$A0,$9F,$AD,$4B,$07,$38,$20,$B1,$FE,$B0,$29,$8E,$4E,$07,$AD,$4B,$07   DATA $38,$ED,$4E,$07,$8D,$4B,$07,$AD,$4C,$07,$8C,$4E,$07,$ED,$4E,$07,$8D,$4C   DATA $07,$AD,$4D,$07,$E9,$00,$8D,$4D,$07,$0D,$4B,$07,$0D,$4C,$07,$D0,$CA,$20   DATA $CC,$FF,$60PALDATA:    DATA $00,$00,$0F,$FF,$08,$00,$0A,$FE,$0C,$4C,$00,$C5,$00,$0A,$0E,$E7,$0D    DATA $85,$06,$40,$0F,$77,$03,$33,$07,$77,$0A,$F6,$00,$8F,$0B,$BB,$00,$00    DATA $01,$11,$02,$22,$03,$33,$04,$44,$05,$55,$06,$66,$07,$77,$08,$88,$09    DATA $99,$0A,$AA,$0B,$BB,$0C,$CC,$0D,$DD,$0E,$EE,$0F,$FF,$02,$11,$04,$33    DATA $06,$44,$08,$66,$0A,$88,$0C,$99,$0F,$BB,$02,$11,$04,$22,$06,$33,$08    DATA $44,$0A,$55,$0C,$66,$0F,$77,$02,$00,$04,$11,$06,$11,$08,$22,$0A,$22    DATA $0C,$33,$0F,$33,$02,$00,$04,$00,$06,$00,$08,$00,$0A,$00,$0C,$00,$0F    DATA $00,$02,$21,$04,$43,$06,$64,$08,$86,$0A,$A8,$0C,$C9,$0F,$EB,$02,$11    DATA $04,$32,$06,$53,$08,$74,$0A,$95,$0C,$B6,$0F,$D7,$02,$10,$04,$31,$06    DATA $51,$08,$62,$0A,$82,$0C,$A3,$0F,$C3,$02,$10,$04,$30,$06,$40,$08,$60    DATA $0A,$80,$0C,$90,$0F,$B0,$01,$21,$03,$43,$05,$64,$07,$86,$09,$A8,$0B    DATA $C9,$0D,$FB,$01,$21,$03,$42,$04,$63,$06,$84,$08,$A5,$09,$C6,$0B,$F7    DATA $01,$20,$02,$41,$04,$61,$05,$82,$06,$A2,$08,$C3,$09,$F3,$01,$20,$02    DATA $40,$03,$60,$04,$80,$05,$A0,$06,$C0,$07,$F0,$01,$21,$03,$43,$04,$65    DATA $06,$86,$08,$A8,$09,$CA,$0B,$FC,$01,$21,$02,$42,$03,$64,$04,$85,$05    DATA $A6,$06,$C8,$07,$F9,$00,$20,$01,$41,$01,$62,$02,$83,$02,$A4,$03,$C5    DATA $03,$F6,$00,$20,$00,$41,$00,$61,$00,$82,$00,$A2,$00,$C3,$00,$F3,$01    DATA $22,$03,$44,$04,$66,$06,$88,$08,$AA,$09,$CC,$0B,$FF,$01,$22,$02,$44    DATA $03,$66,$04,$88,$05,$AA,$06,$CC,$07,$FF,$00,$22,$01,$44,$01,$66,$02    DATA $88,$02,$AA,$03,$CC,$03,$FF,$00,$22,$00,$44,$00,$66,$00,$88,$00,$AA    DATA $00,$CC,$00,$FF,$01,$12,$03,$34,$04,$56,$06,$68,$08,$8A,$09,$AC,$0B    DATA $CF,$01,$12,$02,$24,$03,$46,$04,$58,$05,$6A,$06,$8C,$07,$9F,$00,$02    DATA $01,$14,$01,$26,$02,$38,$02,$4A,$03,$5C,$03,$6F,$00,$02,$00,$14,$00    DATA $16,$00,$28,$00,$2A,$00,$3C,$00,$3F,$01,$12,$03,$34,$05,$46,$07,$68    DATA $09,$8A,$0B,$9C,$0D,$BF,$01,$12,$03,$24,$04,$36,$06,$48,$08,$5A,$09    DATA $6C,$0B,$7F,$01,$02,$02,$14,$04,$16,$05,$28,$06,$2A,$08,$3C,$09,$3F    DATA $01,$02,$02,$04,$03,$06,$04,$08,$05,$0A,$06,$0C,$07,$0F,$02,$12,$04    DATA $34,$06,$46,$08,$68,$0A,$8A,$0C,$9C,$0F,$BE,$02,$11,$04,$23,$06,$35    DATA $08,$47,$0A,$59,$0C,$6B,$0F,$7D,$02,$01,$04,$13,$06,$15,$08,$26,$0A    DATA $28,$0C,$3A,$0F,$3C,$02,$01,$04,$03,$06,$04,$08,$06,$0A,$08,$0C,$09    DATA $0F,$0BINIDATA:   DATA "## THIS IS THE HANGMAN INI FILE "   DATA "## SIMILIAR TO WINDOWS INI FILES-DOES NOT SUPPORT SECTIONS"   DATA ""   DATA "## IF USEZSM IS OFF THEN NO MUSIC"   DATA "## WILL BE PLAYED"   DATA "USEZSM=ON"   DATA ""   DATA "## WHERE SOUND EFFECTS ARE FOUND"   DATA "MUSICDIR=MUSIC"   DATA "SOUNDEFFECTS=SOUNDS"   DATA ""   DATA "## A SONG ON PROGRAM STARTUP"   DATA "INTROSONG=CHOPIN.ZSM"   DATA ""   DATA "BACKGROUNDMUSIC=ON"   DATA ""   DATA "BACKGROUNDTRACK=BACKGROUND1.ZSM"   DATA ""   DATA "LOSSMUSIC=CHOPIN.ZSM"   DATA ""   DATA "VICTORYSOUND=VICTORY.ZSM"   DATA ""   DATA "## ONLY PLAYED ON FANCY ANIMATION"   DATA "VICTORYSONG=NONE"   DATA ""   DATA "## TURN SHOWCLUE OFF IF YOU DON'T WANT"   DATA "## TO SEE CLUES,  MAKES THE GAME HARD !!"   DATA "SHOWCLUE=ON"   DATA ""   DATA "## THE DEFAULT PALETTE"   DATA "## THIS AND UNREM ANOTHER "   DATA "## FOR A DIFFERENT COLOR SCHEME"   DATA ""   DATA "PALFILE=DPAL.BIN"   DATA ""   DATA "## MUTED PALETTE ACCORDING TO"   DATA "## DESERTFISH CLOSER TO TRUE C64"   DATA "## PALFILE=ALTPALETTES/C64.PAL"   DATA ""   DATA "## A PALETTE WITH A REDISH HUE"   DATA "## PALFILE=ALTPALETTES/REDISH.PAL"   DATA ""   DATA "## A PALETTE WITH A BLUISH HUE"   DATA "## PALFILE=ALTPALETTES/BLUEISH.PAL"   DATA ""   DATA "## A GRAYSCALE PALETTE"   DATA "## PALFILE=ALTPALETTES/GRAY.PAL"   DATA ""   DATA "## A PARTIAL GRAYSCALE PALETTE"   DATA "## PALFILE=ALTPALETTES/SEMIGRAY.PAL"   DATA ""   DATA "## A DARK PALETTE"   DATA "## PALFILE=ALTPALETTES/DARK.PAL"   DATA ""   DATA ""