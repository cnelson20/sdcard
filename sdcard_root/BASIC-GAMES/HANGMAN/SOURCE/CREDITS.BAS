
#CONTROLCODES 1
 GOSUB SETREGVARS
 POKE C.REG,1
 SYS SET.MEM
 LAST.BANK = PEEK(A.REG):IF LAST.BANK=0 THEN LAST.BANK=256
 LAST.BANK = LAST.BANK - 1
 BANKS.AVAILABLE = LAST.BANK-2
 NEXT.BANK=2
 GOSUB GETFROMMENU
 GOSUB POKENOFLICKER
 POKE C.REG,1:SYS $FF5F:IF PEEK(A.REG)<>1 THEN GOSUB HIDEALL:MYMODE=1:GOSUB NOFLICKERSCREEN

GOSUB SETDEFAULTPALETTE
## DARK BLUE BACKGROUND
VPOKE 1, $FA0C, $14: VPOKE 1, $FA0D, 0
VPOKE 1, $FA04, $F0:VPOKE 1, $FA05, 0
PRINT:PRINT
PRINT "  {GRN}  HANGMAN{WHT}";
COLOR 1:PRINT "   IS CODED IN {GRN}COMMODORE BASIC{WHT}"
PRINT "    VER {GRN}2.0{WHT} WITH {GRN}CX{LIGHT GREEN}16{WHT} EXTENSIONS"
PRINT "    {LIGHT GREEN}2023{WHT}/{LIGHT GREEN}2024  {GRN}BY{WHT}: ANTHONY W. HENRY"
PRINT:PRINT
PRINT "    {RED}KEY CONTRIBUTORS"
PRINT "    {YEL}****************":COLOR 1
PRINT
PRINT "    {RED}ESSENTIAL TOOLS"
PRINT "    {YEL}---------------"
PRINT "       {GRN}BASLOAD {LIGHT GREEN}   'COMPILER'{WHT}  : STEFAN JAKOBSON"
PRINT "       {GRN} ZSMKIT {LIGHT GREEN}'SOUND LIBRARY'{WHT}: MOOINGLEMUR"
PRINT
PRINT "    {RED}MACHINE LANGUAGE ROUTINES":COLOR 7
PRINT "    {YEL}-------------------------":COLOR 1
PRINT "         {GRN}SCREEN SAVE{WHT}: XARK & FOXWOOF"
PRINT "           {GRN}LINE SKIP{WHT}: MARKTHESTRANGE"
PRINT
PRINT "  {RED}  MUSIC AND SOUND EFFECT CONTRIBUTIONS"
COLOR 7
PRINT "  {YEL}  ------------------------------------":COLOR 1
PRINT "  {WHT}        MOOINGLEMUR, CRISPS, GTR3QQ"
PRINT
PRINT "    {RED}FEEDBACK AND BUG REPORTS":COLOR 7
PRINT "    {YEL}------------------------":COLOR 1
PRINT "          {WHT}VOIDSTAR,TOBOTER,DESERTFISH "
PRINT "          NSKIMN8R & THE 8BG";
GOSUB SHOWTEXT:MOUSE 1

FLUSH:
GET X$:IF X$<>"" THEN FLUSH

GETKEY:
GET X$:IF X$="" AND MB = 0  THEN GETKEY
IF NOT FROM.MENU THEN GOSUB CLEARMEM
IF FROM.MENU THEN LOAD "CONFMENU.PRG"
REBOOT

CLEARMEM:
   FOR A=R0L TO R15H:POKE A,0:NEXT A
   FOR A=$400 TO $600:POKE A,0:NEXT A
   IF NOT FROM.MENU THEN POKE $8C04,0:POKE $8C02, 0
   RETURN

FRAMESCRN:
    X1=0:Y1=0:X2=319:Y2=239
    CC=$A9
    FOR J=1 TO 5
        FRAME X1,Y1,X2,Y2,CC
        X1=X1+1:X2=X2-1
        Y1=Y1+1:Y2=Y2-1
        CC=CC-1
    NEXT J
    RETURN

HIDEALL:
  GOSUB HIDEGRAPHICS:GOTO HIDETEXT
SHOWALL:
  GOSUB SHOWGRAPHICS:GOTO SHOWTEXT

HIDEGRAPHICS:
  POKE VERA.DCVIDEO, PEEK(VERA.DCVIDEO) AND LAYER0.OFF:RETURN

SHOWGRAPHICS:
  POKE VERA.DCVIDEO, PEEK(VERA.DCVIDEO) OR LAYER0.ON:RETURN

HIDETEXT:
  POKE VERA.DCVIDEO, PEEK(VERA.DCVIDEO) AND LAYER1.OFF:RETURN

SHOWTEXT:
  POKE VERA.DCVIDEO, PEEK(VERA.DCVIDEO) OR LAYER1.ON:RETURN

SETREGVARS:
 A.REG = $030C
  X.REG = $030D
  Y.REG = $030E
  C.REG = $030F
  SET.MEM = $FF99
  R0L=$02:R0H=$03:R0=R0L
  R1L=$04:R1H=$05:R1=R1L
  R2L=$06:R2H=$07:R2=R2L
  R3L=$08:R3H=$09:R3=R3L
  R4L=$A:R4H=$B:R4=R4L
  R5L=$C:R5H=$D:R5=R5L
  R6L=$E:R6H=$F:R6=R6L
  R7L=$10:R7H=$11:R7=R7L
  R8L=$12:R8H=$13:R8=R8L
  R9L=$14:R9H=$15:R9=R9L
  R10L=$16:R10H=$17:R10=R10L
  R11L=$18:R11H=$19:R11=R11L
  R12L=$1A:R12H=$1B:R12=R12L
  R13L=$1C:R13H=$1D:R13=R13L
  R14L=$1E:R14H=$1F:R14=R14L
  R15L=$20:R15H=$21:R15=R15L
  CHKOUT=$FFC9:CHKIN=$FFC6:CLRCHN=$FFCC
  MCIOUT=$FEB1:MACPTR=$FF44:
  VERA.DATA0=$9F23:VERA.DATA1=$9F24:VERA.CTRL=$9F25
  VERA.DCVIDEO=$9F29
  LAYER0.ON=16
  LAYER0.OFF=239
  LAYER1.ON=32
  LAYER1.OFF=223
  FB.CURSOR.POSITION=$FEFF
  FB.CURSOR.NEXTLINE=$FF02
  SCREEN.SIZE=$12C00
  RETURN


GETFROMMENU:
  RA=PEEK(0):S$=""
  ADDR=$BF00:BANK LAST.BANK
  FOR I=0 TO 7:S$=S$+CHR$(PEEK(ADDR+I)):NEXT I
  FROM.MENU = (S$="HANGMENU")
  BANK RA:RETURN

NOFLICKERSCREEN:
 POKE A.REG, MYMODE
 SYS $410:RETURN

POKENOFLICKER:
  RESTORE NOFLICKER
  FOR A=$410 TO $443
      READ C:POKE A,C
  NEXT A
  RETURN

SETDEFAULTPALETTE:
 F$="DPAL.BIN":GOSUB FILEEXISTS
 IF FE% THEN BVLOAD F$,8,1,$FA00:RETURN
 RESTORE PALDATA
 POKE $9F20, 0
 POKE $9F21, $FA
 POKE $9F22, %00010001
 FOR I=1 TO 512:READ PALBYTE:POKE $9F23, PALBYTE:NEXT
 RETURN


FILEEXISTS:
  X$=F$:FE%=0:X$=X$+",S,R":OPEN 2,8,2,X$:CLOSE 2:OPEN 15,8,15:INPUT#15,X,X$,A,B
  CLOSE 15:FE%=(X<=20):RETURN


## 52 BYTES
NOFLICKER:
 DATA $5A,$DA,$48,$A9,$FA,$8D,$21,$9F,$A9,$11,$8D,$22,$9F,$A9,$00,$8D
 DATA $20,$9F,$A2,$04,$A0,$80,$8D,$23,$9F,$88,$D0,$FA,$CA,$D0,$F5,$20,$DE,$FF
 DATA $85,$29,$CB,$20,$DE,$FF,$C9,$FF,$F0,$F8,$68,$18,$20,$5F,$FF,$FA,$7A,$60

## Palette DATA GB,R,GB,R .....
PALDATA:
  DATA 0,0,$FF,15,0,8,$FE,10,76,12,$C5,0,10,0,$E7,14,$85,$D
  DATA 64,6,$77,15,51,3,$77,7,$F6,10,$8F,0,$BB,11,0,0,17,1
  DATA 34,2,51,3,68,4,85,5,$66,6,$77,7,$88,8,$99,9,$AA,10
  DATA $BB,11,$CC,12,$DD,13,$EE,14,$FF,15,17,2,51,4,68,6,$66,8
  DATA $88,10,$99,12,$BB,15,17,2,34,4,51,6,68,8,85,10,$66,$C
  DATA $77,15,0,2,17,4,17,6,34,8,34,10,51,12,51,15,0,2
  DATA 0,4,0,6,0,8,0,10,0,12,0,15,$21,2,67,4,$64,6
  DATA $86,8,$A8,10,$C9,12,$EB,15,17,2,50,4,83,6,$74,8,$95,10
  DATA $B6,12,$D7,15,16,2,49,4,81,6,98,8,$82,10,$A3,12,$C3,15
  DATA 16,2,48,4,64,6,96,8,$80,10,$90,12,$B0,15,$21,$1,67,3
  DATA $64,5,$86,7,$A8,9,$C9,11,$FB,13,$21,$1,66,,3,99,4,$84,6
  DATA $A5,8,$C6,9,$F7,11,32,$1,65,2,97,4,$82,5,$A2,6,$C3,8
  DATA $F3,9,32,$1,64,2,96,3,$80,4,$A0,5,$C0,6,$F0,7,$21,1
  DATA 67,3,$65,4,$86,6,$A8,8,$CA,9,$FC,11,$21,$1,66,,2,$64,3
  DATA $85,4,$A6,5,$C8,6,$F9,7,32,0,65,$1,98,$1,$83,2,$A4,2
  DATA $C5,3,$F6,3,32,0,65,0,97,0,$82,0,$A2,0,$C3,0,$F3,0
  DATA 34,$1,68,3,$66,4,$88,6,$AA,8,$CC,9,$FF,11,34,$1,68,2
  DATA $66,3,$88,4,$AA,5,$CC,6,$FF,7,34,0,68,$1,$66,$1,$88,2
  DATA $AA,2,$CC,3,$FF,3,34,0,68,0,$66,0,$88,0,$AA,0,$CC,0
  DATA $FF,0,18,$1,52,3,86,4,$68,6,$8A,8,$AC,9,$CF,11,18,1
  DATA 36,2,70,3,88,4,$6A,5,$8C,6,$9F,7,2,0,20,$1,38,1
  DATA 56,2,74,2,92,3,$6F,3,2,0,20,0,22,0,40,0,42,0
  DATA 60,0,63,0,18,1,52,3,70,5,$68,7,$8A,9,$9C,11,$BF,13
  DATA 18,$1,36,3,54,4,72,6,90,8,$6C,9,$7F,11,2,$1,20,2
  DATA 22,4,40,5,42,6,60,8,63,9,2,$1,4,2,6,3,8,$4
  DATA 10,5,12,6,15,7,18,2,52,4,70,6,$68,8,$8A,10,$9C,$C
  DATA $BE,15,17,2,35,4,53,6,71,8,89,10,$6B,12,$7D,15,1,2
  DATA 19,4,21,6,38,8,40,10,$3A,12,60,15,1,2,3,4,4,6
  DATA 6,8,8,10,9,12,11,15
