SCREEN $80
GOSUB BIGWINANIM
END

BIGWINANIM:
   GOSUB BLOCKSMILE
   F$="ANIMS/ANIMPAL.BIN":GOSUB FILEEXISTS
   F1%=FE%
   F$="ANIMS/ANIM16.BIN":GOSUB FILEEXISTS
   F2%=FE%
   F$="ANIMS/ANIM50.BIN":GOSUB FILEEXISTS
   F1%=F1% AND F2% AND FE%
   GOSUB PAL2BLACK
   IF F1% THEN BVLOAD "ANIMS/ANIMPAL.BIN",8,1,$FA00
   P1=$10:R%=0:G%=0:B%=0:GOSUB RGBPAL
   RECT 0,0,319,239,$10
   R%=13:G%=13:B%=13:P1=15:GOSUB RGBPAL
   P1=7:R%=13:G%=0:B%=3:GOSUB RGBPAL
   P1=252:R%=6:G%=8:B%=2:GOSUB RGBPAL
   REM P1=10:GOSUB RGBPAL:P1=14:GOSUB RGBPAL
   P1=253:R%=5:G%=11:GOSUB RGBPAL
   RECT 0,234,319,239,252
   RECT 0,175,319,233,153
   UC=0:DC$=CHR$(255)
   COLOR 7,0
   REM X=1: Y=3:WD$="FLAW-":GOSUB BIGWORD
   REM X=5:Y=12:WD$="LESS":GOSUB BIGWORD
   X=4: Y=3:WD$="5 IN":GOSUB BIGWORD
   X=1:Y=12:WD$="A ROW":GOSUB BIGWORD
   I=1
   GOSUB FIREWORKS
   IF NOT F1% THEN THEEND;
   CHAR 4,158,156,CHR$($0C)+"A REPRIEVE !!!"
   CHAR 4,170,15,CHR$($0C)+"LETS GET OUT OF HERE...."
   CHAR 160,170,156, CHR$($0C)+" .. EXIT .. STAGE RIGHT !!"
ANIMLOOP:
   F$=STR$(I):F$=RIGHT$(F$,LEN(F$)-1)
   F$="ANIMS/ANIM"+F$+".BIN"
   BVLOAD F$,8,0,$DAC0
   I=I+1:IF I>50 THEN THEEND
   GET X$:IF X$=CHR$(27) THEN THEEND
   GOTO ANIMLOOP
THEEND:
    RECT 0,175,319,233,156:GOSUB PAL2BLACK
    RECT 0,0,319,239,$10:GOSUB SETDEFPAL
   RETURN


FIREWORKS:
STARTLOOP:
  FOR WF=0 TO 6
GETRANDS:
    X=INT(RND(.)*300+15)
    Y=INT(RND(.)*90+30)
    L1 = X-2:L2=Y-2:L3=318-X:L4=146-Y

    SI=INT(RND(.)*25)
    IF SI>L1 OR SIZE>L2 OR SIZE>L3 OR SIZE>L4 THEN GETRANDS

    DELAY=8
    FOR UP=172 TO Y STEP -1
        RECT X, UP,X+1,UP+1, $3F:FOR I=0 TO DELAY:NEXT I:RECT X, UP,X+1,UP+1, $10
    NEXT UP

    PSET X,Y, 7

    FOR O = 0 TO 28 STEP 4
        FOR EX = 0 To 6 STEP 2
            GET X$
            IF X$ <> "" THEN END
            B1=INT(RND(.)*SIZE)+O:B2=INT(RND(.)*SIZE)+O
            X1=X-INT(RND(.)*B1):Y1=Y-RND(.)*B2
            GOSUB ADJUST
            RECT X1,Y1,X1+1,Y1+1,CC
            X1=X+RND(.)*B1:Y1=Y+RND(.) * B2
            GOSUB ADJUST:PSET X1%,Y1%,CC
            X1=X+ RND(.)*B1:Y1 =Y-RND(.)*B2
            GOSUB ADJUST:RECT X1,Y1,X1+1,Y1+1,CC
            X1=X-RND(.)*B1:Y1=Y+RND(.)*B2
            GOSUB ADJUST:RECT X1,Y1,X1+1,Y1+1,CC
        NEXT EX
    NEXT O
    RECT 0,0,319,146,$10
  NEXT WF
RETURN

ADJUST:
   IF X1>318 THEN X1=318
   IF X1<0 THEN X1=0
   IF Y1<0 THEN Y1=0
   IF Y1>238 THEN Y1=238
   CC=INT(RND(.)*254)+1
  RETURN


BLOCKSMILE:
 VPOKE 1,$F2F0,%00111100
 VPOKE 1,$F2F1,%01111110
 VPOKE 1,$F2F2,%11011011
 VPOKE 1,$F2F3,%11111111
 VPOKE 1,$F2F4,%10111101
 VPOKE 1,$F2F5,%11000011
 VPOKE 1,$F2F6,%01111110
 VPOKE 1,$F2F7,%00111100
 RETURN

BIGWORD:
      L=LEN(WD$):SX = X
      OB=PEEK(1):BANK PEEK(0),6
      FOR K=1 TO L
         CC=ASC(MID$(WD$,K,1))
         IF (CC>=64 AND CC<=90) OR (CC>=193 AND CC<=218) THEN AA=64:GOTO SKIP0
         AA=0
SKIP0:
         CA=$C000 + 8*(CC-AA)
         FOR I=1 TO 8
             CM(I) = PEEK(CA+(I-1)):CM$(I)=""
         NEXT I
         IF DC$="" THEN DC$=CHR$(CC)
          FOR J=1 TO 8
             RESTORE BITMAPS
             FOR CT=1 TO 8
                READ CP
                IF (CP AND CM(J)) THEN CM$(J)=CM$(J)+DC$:GOTO SKIPSPC
                CM$(J)=CM$(J)+CHR$(32)
          SKIPSPC:
             NEXT CT
             LOCATE Y+(J-1),X:IF UC=1 THEN COLOR TC%(1,J),TC%(2,J)
             PRINT CM$(J);
          NEXT J
          IF DC$=CHR$(CC) THEN DC$=""
          X=X+8
      NEXT K
      X=SX:BANK PEEK(0),OB
      RETURN


REM SET PALLETTE ENTRY P1 TO R%,G%,B%
RGBPAL:
      A=P1*2:GB%=(G%*16)+B%
      A=A+$FA00
      SLEEP:VPOKE 1,A,GB%
      A=A+1
      SLEEP:VPOKE 1,A,R%
      RETURN

REM SET THE PALLETTE TO ALL BLACK
PAL2BLACK:
    FOR A=$FA00 TO $FBFF:VPOKE 1,A,0:NEXT A:RETURN

SETDEFPAL:
      F$="DPAL.BIN":GOSUB FILEEXISTS
      IF FE% THEN BVLOAD F$,8,1,$FA00:RETURN
      RESTORE PALDATA
REM LOOP THROUGH THE PALLETTE ADDRESS SPACE
REM AND POKE THE VERA DEFAULT PALLETTE
      FOR PE = $FA00 TO $FBFE STEP 2
          READ R:READ GB
          VPOKE 1,PE,GB
          VPOKE 1,PE+1, R
      NEXT PE
      RETURN

BITMAPS:
      DATA 128,64,32,16,8,4,2,1,0


PALDATA:
      DATA $00,$00,$0F,$FF,$08,$00,$0A,$FE,$0C,$4C,$00,$C5,$00,$0A,$0E,$E7,$0D
      DATA $85,$06,$40,$0F,$77,$03,$33,$07,$77,$0A,$F6,$00,$8F,$0B,$BB,$00,$00
      DATA $01,$11,$02,$22,$03,$33,$04,$44,$05,$55,$06,$66,$07,$77,$08,$88,$09
      DATA $99,$0A,$AA,$0B,$BB,$0C,$CC,$0D,$DD,$0E,$EE,$0F,$FF,$02,$11,$04,$33
      DATA $06,$44,$08,$66,$0A,$88,$0C,$99,$0F,$BB,$02,$11,$04,$22,$06,$33,$08
      DATA $44,$0A,$55,$0C,$66,$0F,$77,$02,$00,$04,$11,$06,$11,$08,$22,$0A,$22
      DATA $0C,$33,$0F,$33,$02,$00,$04,$00,$06,$00,$08,$00,$0A,$00,$0C,$00,$0F
      DATA $00,$02,$21,$04,$43,$06,$64,$08,$86,$0A,$A8,$0C,$C9,$0F,$EB,$02,$11
      DATA $04,$32,$06,$53,$08,$74,$0A,$95,$0C,$B6,$0F,$D7,$02,$10,$04,$31,$06
      DATA $51,$08,$62,$0A,$82,$0C,$A3,$0F,$C3,$02,$10,$04,$30,$06,$40,$08,$60
      DATA $0A,$80,$0C,$90,$0F,$B0,$01,$21,$03,$43,$05,$64,$07,$86,$09,$A8,$0B
      DATA $C9,$0D,$FB,$01,$21,$03,$42,$04,$63,$06,$84,$08,$A5,$09,$C6,$0B,$F7
      DATA $01,$20,$02,$41,$04,$61,$05,$82,$06,$A2,$08,$C3,$09,$F3,$01,$20,$02
      DATA $40,$03,$60,$04,$80,$05,$A0,$06,$C0,$07,$F0,$01,$21,$03,$43,$04,$65
      DATA $06,$86,$08,$A8,$09,$CA,$0B,$FC,$01,$21,$02,$42,$03,$64,$04,$85,$05
      DATA $A6,$06,$C8,$07,$F9,$00,$20,$01,$41,$01,$62,$02,$83,$02,$A4,$03,$C5
      DATA $03,$F6,$00,$20,$00,$41,$00,$61,$00,$82,$00,$A2,$00,$C3,$00,$F3,$01
      DATA $22,$03,$44,$04,$66,$06,$88,$08,$AA,$09,$CC,$0B,$FF,$01,$22,$02,$44
      DATA $03,$66,$04,$88,$05,$AA,$06,$CC,$07,$FF,$00,$22,$01,$44,$01,$66,$02
      DATA $88,$02,$AA,$03,$CC,$03,$FF,$00,$22,$00,$44,$00,$66,$00,$88,$00,$AA
      DATA $00,$CC,$00,$FF,$01,$12,$03,$34,$04,$56,$06,$68,$08,$8A,$09,$AC,$0B
      DATA $CF,$01,$12,$02,$24,$03,$46,$04,$58,$05,$6A,$06,$8C,$07,$9F,$00,$02
      DATA $01,$14,$01,$26,$02,$38,$02,$4A,$03,$5C,$03,$6F,$00,$02,$00,$14,$00
      DATA $16,$00,$28,$00,$2A,$00,$3C,$00,$3F,$01,$12,$03,$34,$05,$46,$07,$68
      DATA $09,$8A,$0B,$9C,$0D,$BF,$01,$12,$03,$24,$04,$36,$06,$48,$08,$5A,$09
      DATA $6C,$0B,$7F,$01,$02,$02,$14,$04,$16,$05,$28,$06,$2A,$08,$3C,$09,$3F
      DATA $01,$02,$02,$04,$03,$06,$04,$08,$05,$0A,$06,$0C,$07,$0F,$02,$12,$04
      DATA $34,$06,$46,$08,$68,$0A,$8A,$0C,$9C,$0F,$BE,$02,$11,$04,$23,$06,$35
      DATA $08,$47,$0A,$59,$0C,$6B,$0F,$7D,$02,$01,$04,$13,$06,$15,$08,$26,$0A
      DATA $28,$0C,$3A,$0F,$3C,$02,$01,$04,$03,$06,$04,$08,$06,$0A,$08,$0C,$09
      DATA $0F,$0B

    FILEEXISTS:
      X$=F$:FE%=0:X$=X$+",S,R"
      OPEN 2,8,2,X$
      CLOSE 2
      OPEN 15,8,15
      INPUT#15,X,X$
      CLOSE 15
      FE%=(X<=20)
      RETURN

